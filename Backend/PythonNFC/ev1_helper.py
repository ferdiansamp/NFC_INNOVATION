# Helper APDU untuk DESFire EV1
def apdu_get_version():
    return bytearray([0x90, 0x60, 0x00, 0x00, 0x00])

def apdu_select_application(aid=[0x00,0x00,0x00]):
    return bytearray([0x90, 0x6A, 0x00, 0x00, 0x03] + aid + [0x00])

def apdu_create_application(aid=[0x11,0x22,0x33], key_settings=0x0F):
    return bytearray([0x90, 0x5A, 0x00, 0x00, 0x05] + aid + [key_settings, 0x00])

def apdu_create_std_data_file(file_id=0x01, size=32):
    return bytearray([0x90, 0xCD, 0x00, 0x00, 0x07,
                      file_id, 0x00, 0x00, size, 0x00, 0x00, 0x00])

def apdu_write_data(file_id=0x01, data=b"KODE12345"):
    Lc = len(data) + 7
    return bytearray([0x90, 0x3D, 0x00, 0x00, Lc,
                      file_id, 0x00, 0x00, len(data), 0x00, 0x00, 0x00]) + data + b"\x00"

def apdu_read_data(file_id=0x01, length=32):
    return bytearray([0x90, 0xBD, 0x00, 0x00, 0x07,
                      file_id, 0x00, 0x00, length, 0x00, 0x00, 0x00])
